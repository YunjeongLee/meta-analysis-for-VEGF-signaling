# Run a linear regression and save the results in regresults to use with
# the summary() function
regresults <-lm(cadia ~ tnf, data=perio1class)
# Summary of the linear regression results and save the results for later use
# in creating scatter plot displaying the linear regression results
regsum <- summary(regresults)
regsum
# 95% confidence interval for the regression coefficients and save the
# results for later use
regci <- confint(regresults, level = 0.95)
regci
# Using the classic theme which has no shading for reference lines
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =55, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=0) +
annotate(geom ="text", x =55, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=0) +
annotate(geom ="text", x =55, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=0)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =25, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=0) +
annotate(geom ="text", x =25, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=0) +
annotate(geom ="text", x =25, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=0)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=0) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=0) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=0)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=1) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=0) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=0)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=1) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=1) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=1) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=1) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=1) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=4) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=1) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=1) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=1) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=2)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.5)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.75)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.70)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2.1) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.70)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2.05) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.70)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2.04) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.70)
ggplot(data=perio1class, aes(x=tnf, y=cadia, color=condition)) +
geom_point(size =2 , alpha = 1.0) +
geom_smooth(method="loess", color="darkgrey", se=FALSE, linetype=2) +
geom_smooth(method="lm", color="black") +
labs(color = "Condition", x = "Tumor necrosis factor alpha",
y = "Change in bone density (CADIA)") +
theme_classic() +
annotate(geom ="text", x =20, y = 8,
label =paste("Slope = ", round(regsum$coefficients[2,1],2)),
adj=2) +
annotate(geom ="text", x =20, y = 6,
label =paste("P-value = ", round(regsum$coefficients[2,4],2)),
adj=2) +
annotate(geom ="text", x =20, y = 4,
label =paste("R-squared = ", 100*round(regsum$r.squared,2),"%",
sep = ""), adj=1.70)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
vegfr1$Ligand <- "VEGFR1"
vegfr2$Ligand <- "VEGFR2"
nrp1$Ligand <- "NRP1"
df1 = rbind(vegfr1[c("Ligand", "koff")],
vegfr2[c("Ligand", "koff")],
nrp1[c("Ligand", "koff")])
#koff
p = ggplot() +
geom_point(data = vegfr1, aes(x = "VEGFR1", y = koff*1e3, colour = Reference), size = 7) +
geom_point(data = vegfr1, aes(x = "VEGFR1", y=rm_vegfr1_koff$b*1e3), shape = 95, size=20, colour = "darkblue") +
labs(color="VEGFR1") +
lightness(scale_color_brewer(palette="Blues"), scalefac(0.8)) +
guides(color = guide_legend(order=1)) +
new_scale_color() +
geom_point(data = vegfr2, aes(x = "VEGFR2", y = koff*1e3, colour = Reference), size = 7) +
geom_point(data = vegfr2, aes(x = "VEGFR2", y=rm_vegfr2_koff$b*1e3), shape = 95, size=20, colour = "darkgreen") +
labs(color="VEGFR2") +
lightness(scale_color_colormap('VEGFR2', discrete = T,colormap = "greens", reverse = T), scalefac(0.8)) +
guides(color = guide_legend(order=2)) +
new_scale_color() +
geom_point(data = nrp1, aes(x = "NRP1", y = koff*1e3, colour = Reference), size = 7) +
geom_point(data = nrp1, aes(x = "NRP1", y=rm_nrp1_koff$b*1e3), shape = 95, size=20, colour = "darkred") +
labs(color="NRP1") +
lightness(scale_color_brewer(palette="Oranges"),scalefac(0.8)) +
guides(color = guide_legend(order=3)) +
xlab("") + ylab(TeX("koff")) +
scale_y_continuous(trans= 'log10', breaks=trans_breaks('log10', function(x) 10^x),
labels=trans_format('log10', math_format(10^.x)), limits = c(1e-3, 1e5),
sec.axis = sec_axis(trans=~./1e3, name="koff ",
breaks=trans_breaks('log10', function(x) 10^x),
labels=trans_format('log10', math_format(10^.x)))) +
geom_bracket(data = df1, aes(x = Ligand, y = koff), xmin = "VEGFR1", xmax = "NRP1",
y.position = 4, tip.length = c(0.2, 0.1),
label = generate_plabel(vegfr1_vs_nrp1koff$coefficients["p.value"])) +
geom_bracket(data = df1, aes(x = Ligand, y = koff), xmin = "VEGFR1", xmax = "VEGFR2",
y.position = 1, tip.length = c(0.1, 0.1),
label = generate_plabel(vegfr1_vs_vegfr2koff$coefficients["p.value"])) +
scale_x_discrete(limits=c("VEGFR1", "VEGFR2", "NRP1")) +
ggtitle("Comparison of VEGF-A koffs to its receptors") +
theme(text = element_text(size = 20),
plot.title = element_text(hjust = 0.5, face="bold"))
show(p)
ggsave(sprintf("%s/koff.png", results_path), width=4500, height=3000, units="px")
dev.off()
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
vegfr1$Ligand <- "VEGFR1"
vegfr2$Ligand <- "VEGFR2"
df1 = rbind(vegfr1[c("Ligand", "koff")],
vegfr2[c("Ligand", "koff")])
#koff
p = ggplot() +
geom_point(data = vegfr1, aes(x = "VEGFR1", y = koff*1e3, colour = Reference), size = 7) +
geom_point(data = vegfr1, aes(x = "VEGFR1", y=rm_vegfr1_koff$b*1e3), shape = 95, size=20, colour = "darkblue") +
labs(color="VEGFR1") +
lightness(scale_color_brewer(palette="Blues"), scalefac(0.8)) +
guides(color = guide_legend(order=1)) +
new_scale_color() +
geom_point(data = vegfr2, aes(x = "VEGFR2", y = koff*1e3, colour = Reference), size = 7) +
geom_point(data = vegfr2, aes(x = "VEGFR2", y=rm_vegfr2_koff$b*1e3), shape = 95, size=20, colour = "darkgreen") +
labs(color="VEGFR2") +
lightness(scale_color_colormap('VEGFR2', discrete = T,colormap = "greens", reverse = T), scalefac(0.8)) +
guides(color = guide_legend(order=2)) +
xlab("") + ylab(TeX("koff")) +
scale_y_continuous(trans= 'log10', breaks=trans_breaks('log10', function(x) 10^x),
labels=trans_format('log10', math_format(10^.x)), limits = c(1e-3, 1e5),
sec.axis = sec_axis(trans=~./1e3, name="koff ",
breaks=trans_breaks('log10', function(x) 10^x),
labels=trans_format('log10', math_format(10^.x)))) +
geom_bracket(data = df1, aes(x = Ligand, y = koff), xmin = "VEGFR1", xmax = "VEGFR2",
y.position = 1e-2, tip.length = c(0.1, 0.1),
label = generate_plabel(vegfr1_vs_vegfr2koff$coefficients["p.value"])) +
scale_x_discrete(limits=c("VEGFR1", "VEGFR2")) +
ggtitle("Comparison of VEGF-A koffs to its receptors") +
theme(text = element_text(size = 20),
plot.title = element_text(hjust = 0.5, face="bold"))
show(p)
ggsave(sprintf("%s/koff.png", results_path), width=4500, height=3000, units="px")
dev.off()
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
View(vegfr1)
View(vegfr1)
View(vegfr1)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
View(vegfkonkoff)
View(vegfkonkoff)
View(VEGF165VEGFR2)
View(VEGF165VEGFR2)
View(VEGF165VEGFR2)
View(VEGF165VEGFR2)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
View(vegfr1)
View(vegfr1)
View(vegfr2)
View(vegfr2)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_receptors_binding_affinity.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_receptors_binding_affinity.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
View(vegfr2)
View(vegfr2)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
# kon
png(file=sprintf("%s/forest_vegfr1vegf165_kon.png", results_path), width=1500, height=700)
forest_ylee(data=vegfr1, rm=rm_vegfr1_kon, slab=vegfr1$Reference,
unit = paste0("M", stri_unescape_unicode(gsub("<U\\+(....)>", "\\\\u\\1", "<U+207B><U+00B9> s<U+207B><U+00B9>"))),
title="kon of VEGF-A165:VEGFR1",
xlab="kon", xlim = c(-3e+7, 0.75e+8), alim = c(0, 3e+7), cex=2, atransf=1e-9)
dev.off()
png(file=sprintf("%s/forest_vegfr2vegf165_kon.png", results_path), width=1300, height=700)
forest_ylee(data=vegfr2, rm=rm_vegfr2_kon, slab=vegfr2$Reference,
unit = paste0("M", stri_unescape_unicode(gsub("<U\\+(....)>", "\\\\u\\1", "<U+207B><U+00B9> s<U+207B><U+00B9>"))),
title="kon of VEGF-A165:VEGFR2",
xlab="kon", xlim = c(-0.5e+7, 1.4e+7), alim = c(0, 0.5e+7), cex=2)
dev.off()
png(file=sprintf("%s/forest_nrp1vegf165_kon.png", results_path), width=1300, height=700)
forest_ylee(data=nrp1, rm=rm_nrp1_kon, slab=nrp1$Reference,
unit = paste0("M", stri_unescape_unicode(gsub("<U\\+(....)>", "\\\\u\\1", "<U+207B><U+00B9> s<U+207B><U+00B9>"))),
title="kon of VEGF-A165:NRP1",
xlab="kon", xlim = c(-0.3e+7, 1e+7), alim = c(0, 0.3e+7), cex=2)
dev.off()
# koff
png(file=sprintf("%s/forest_vegfr1vegf165_koff.png", results_path), width=1300, height=700)
forest_ylee(data=vegfr1, rm=rm_vegfr1_koff, slab=vegfr1$Reference,
unit = paste0("s", stri_unescape_unicode(gsub("<U\\+(....)>", "\\\\u\\1", "<U+207B><U+00B9>"))),
title="koff of VEGF-A165:VEGFR1",
xlab="koff", xlim = c(-1e-3, 1.9e-3), alim = c(0, 1e-3), cex=2)
dev.off()
png(file=sprintf("%s/forest_vegfr2vegf165_koff.png", results_path), width=1300, height=700)
forest_ylee(data=vegfr2, rm=rm_vegfr2_koff, slab=vegfr2$Reference,
unit = paste0("s", stri_unescape_unicode(gsub("<U\\+(....)>", "\\\\u\\1", "<U+207B><U+00B9>"))),
title="koff of VEGF-A165:VEGFR2",
xlab="koff", xlim = c(-1e-3, 1.9e-3), alim = c(0, 1e-3), cex=2)
dev.off()
png(file=sprintf("%s/forest_nrp1vegf165_koff.png", results_path), width=1300, height=700)
forest_ylee(data=nrp1, rm=rm_nrp1_koff, slab=nrp1$Reference,
unit = paste0("s", stri_unescape_unicode(gsub("<U\\+(....)>", "\\\\u\\1", "<U+207B><U+00B9>"))),
title="koff of VEGF-A165:NRP1",
xlab="koff", xlim = c(-0.5e-2, 1e-2), alim = c(0, 0.5e-2), cex=2)
dev.off()
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
source("C:/Users/lione/Desktop/GitHub/meta-analysis-for-VEGF-signaling/code/R/compare_VEGF_binding_to_VEGFR1vsVEGFR2vsNRP1.R", echo=TRUE)
